<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>General config - ServiceComb Java Chassis 开发指南</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "General config";
    var mkdocs_page_input_path = "config\\general-config.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ServiceComb Java Chassis 开发指南</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../start/terminology/">Glossary</a>
                </li>
                <li class="">
                    
    <a class="" href="../../start/architecture/">Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../start/development-environment/">Development environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../start/first-sample/">Develop the first microservice</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Development Service Provider</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../build-provider/definition/service-definition/">Service definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/define-contract/">Service contract definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/code-first/">Implicit API definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/swagger-annotation/">Use Swagger annotations</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/springmvc/">Develop with SpringMVC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/jaxrs/">Develop with JAX-RS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/transparent-rpc/">Develop with Transparent RPC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/interface-constraints/">Interface definition and data type</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/listen-address-and-publish-address/">Service listening address and publishing address</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/thread-pool/">Thread pool</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Service Configuration</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/lb-strategy/">Load Balancing Policy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/ratelimite-strategy/">Rate Limiting Policy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/downgrade-strategy/">Fallback Policy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/parameter-validator/">Parameter Validator</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/bootup/">Boot-up Process</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/access-log-configuration/">Access Log Configuration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Writing Service Consumer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../build-consumer/common-configuration/">Consumer common configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/using-resttemplate/">Using Rest Template</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/using-AsyncRestTemplate/">Using AsynRestTemplate</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/develop-consumer-using-rpc/">Using with RPC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/with-contract/">Contract</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Invoke control</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../build-consumer/circuit-breaker/">Circuit Breaker</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-consumer/flow-control/">Flow Control</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-consumer/fault-injection/">Fault Injection</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/3rd-party-service-invoke/">Invoke 3rd-party REST services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Transports</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../transports/rest-over-servlet/">REST over Servlet</a>
                </li>
                <li class="">
                    
    <a class="" href="../../transports/rest-over-vertx/">REST over Vertx</a>
                </li>
                <li class="">
                    
    <a class="" href="../../transports/highway-rpc/">Highway</a>
                </li>
                <li class="">
                    
    <a class="" href="../../transports/http2/">HTTP2</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">General Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../general-development/visit-sc/">Access Service Center</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/metrics/">Metrics</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/microservice-invocation-chain/">Microservice invocation chain</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/customized-tracing/">Customized-Tracing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/local-develop-test/">Local development and testing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/http-filter/">Http Filter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/file-upload/">File Uploading</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/file-download/">File Downloading</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/reactive/">Reactive Programing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/dnsconfig/">DNS Custom Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/dai-li-she-zhi/">Proxy Settings</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/report-framework-version/">Report framework version</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/cross-app-invocation/">Cross-application invocation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/secret-field/">Customized serialization and deserialization</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/context/">Using Context to pass control messages</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/produceprocess/">Return value serialization extension</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/CORS/">CORS mechanism</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/AlarmEvent/">Get fuse and instance isolation alarm event information</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/shutdown/">Shutdown gracefully</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/error-handling/">Handling exceptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/multienvironment/">Multi-environment isolation between microservice instances</a>
                </li>
                <li class="">
                    
    <a class="" href="../../general-development/thread-model/">Thread Model</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">General config</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#general-configuration-instructions">General configuration instructions</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#configuration-source-hierarchical-relationship">Configuration source hierarchical relationship</a></li>
        
            <li><a class="toctree-l4" href="#get-configuration-information-in-the-program">Get configuration information in the program</a></li>
        
            <li><a class="toctree-l4" href="#performing-configuration-item-mapping">Performing configuration item mapping</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../inject-config/">Configuration injection</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Service Capability Open</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../edge/by-servicecomb-sdk/">Using Edge Service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../edge/nginx/">Using confd and Nginx as edge services</a>
                </li>
                <li class="">
                    
    <a class="" href="../../edge/zuul/">Use zuul as edge services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Service Packing and Running</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../packaging/standalone/">Standalone mode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../packaging/web-container/">WEB container mode</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Micro Service Security</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../security/tls/">Using TLS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../security/rsa/">Using RSA certification</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Using java chassis in Spring Boot</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/components-for-spring-boot/">spring boot starter for java-chassis</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/java-application/">JAVA application development</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/web-application/">Web development method development</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/diff-between-java-web/">The difference between JAVA application method and Web development method</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/diff-spring-mvc/">The difference in Spring MVC mode</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Handlers reference</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../references-handlers/loadbalance/">Load Balancing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references-handlers/publickey/">Public key authentication</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">FAQ</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../question-and-answer/interface-compatibility/">Micro Service Interface Compatibility FAQ</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ServiceComb Java Chassis 开发指南</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Configuration &raquo;</li>
        
      
    
    <li>General config</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="general-configuration-instructions">General configuration instructions</h1>
<h2 id="configuration-source-hierarchical-relationship">Configuration source hierarchical relationship</h2>
<p>ServiceComb provides a hierarchical configuration mechanism. According to the priority, it is divided as below(the former is higher):
* Configuration Center (dynamic configuration)
* Java System Property (-D parameter)
* Environmental variables
* Configuration file</p>
<h3 id="configuration-file">Configuration file</h3>
<p>The configuration file is the microservice.yaml file on classpath by default. When the ServiceComb-Java-Chassis is booting up, the microservice.yaml files are loaded from the jar files and the directories on the hard disks. All of the configuration files are merged into a set of valid configurations. The configuration files on the hard disks has higher priority than those in the jar files. The priority can also be specified by the <code>servicecomb-config-order</code> item in the configuration files.</p>
<blockquote>
<p>Tips: Since the microservice.yaml file on the hard disk has a higher priority, the <code>.</code> directory can be added into the classpath of the executable jar package, so that a microservice.yaml file can be placed in the directory where the service jar package is located, to overwrite the configuration files in the jar package.</p>
</blockquote>
<p>The default name of the configuration files is "microservice.yaml". The additional configuration files can be added by specifying Java System Property, and the name of the configuration files can be changed in this way, too:</p>
<table>
<thead>
<tr>
<th>Java System Property Variable Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>servicecomb.configurationSource.additionalUrls</td>
<td>List of configuration files, multiple full file names can be specified with the ',' as separator</td>
</tr>
<tr>
<td>servicecomb.configurationSource.defaultFileName</td>
<td>Default configuration file name</td>
</tr>
</tbody>
</table>
<h3 id="environmental-variables">Environmental variables</h3>
<p>On Linux, the <code>.</code> charactor cannot be contained into environment variable name. As a result, some configuration items cannot be specified into environment variables directly. As a solution, the <code>.</code> charactor can be replaced by <code>_</code>, and the converted configuration item can be specified as environment variable. ServiceComb-Java-Chassis can map those converted configuration items to the original configuration items.</p>
<p>For example, for the configration in microservice.yaml file:</p>
<pre><code class="yaml">servicecomb:
  rest:
    address: 0.0.0.0:8080
</code></pre>

<p>We can specify <code>servicecomb_rest_address=0.0.0.0:9090</code> in the environment variable to overwrite the server port as 9090. This mapping mechanism can also applied to other configuration levels.</p>
<h3 id="configuration-center-dynamic-configuration">Configuration Center (dynamic configuration)</h3>
<p>The default implementation of the dynamic configuration is the config-cc client, which is connected to the configuration center. The configuration items are as follows:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>servicecomb.config.client.refreshMode</td>
<td>Application configuration refresh mode, <code>0</code> is config-center active push, <code>1</code> is client cycle pull, default is <code>0</code></td>
</tr>
<tr>
<td>servicecomb.config.client.refreshPort</td>
<td>config-center push configured port</td>
</tr>
<tr>
<td>servicecomb.config.client.tenantName</td>
<td>Application tenant name</td>
</tr>
<tr>
<td>servicecomb.config.client.serverUri</td>
<td>config-center access address, the format is <code>http(s)://{ip}:{port}</code>, to separate multiple addresses with comma (optional, when cse.config.client.regUri is configured as This configuration item will take effect when empty))</td>
</tr>
<tr>
<td>servicecomb.config.client.refresh_interval</td>
<td>the configuration refresh interval, the unit is millisecond, default value is 30000</td>
</tr>
</tbody>
</table>
<h2 id="get-configuration-information-in-the-program">Get configuration information in the program</h2>
<p>Developers use a consistent API to get the configuration, regardless of the configured storage path:</p>
<pre><code class="java">DynamicDoubleProperty myprop = DynamicPropertyFactory.getInstance().getDoubleProperty(&quot;trace.handler.sampler.percent&quot;, 0.1);
</code></pre>

<p>The instance above shows a configuration item whose key is <code>trace.handler.sampler.percent</code>, with default value 0.1. Developers can specify the value of this item in the microservice.yaml file, environment variable, Java System Property or Configuration center. <strong>There is no need for the developers to consider where to get the configuration values, Java-Chassis will load the configurations from everywhere, and merge them into one set of configurations according to the priority rule mentioned above.</strong></p>
<p>For details, please refer to [API DOC] (https://netflix.github.io/archaius/archaius-core-javadoc/com/netflix/config/DynamicPropertyFactory.html)</p>
<p>You can register for a callback to handle configuration changes:</p>
<pre><code class="java"> myprop.addCallback(new Runnable() {
      public void run() {
        // this method is invoked when the value of this configuration item is modified
        System.out.println(&quot;trace.handler.sampler.percent is changed!&quot;);
      }
  });
</code></pre>

<h2 id="performing-configuration-item-mapping">Performing configuration item mapping</h2>
<p>In some cases, we want to block the configuration of some of the open source components we use and provide our users with their own configuration items. In this case, you can define the mapping through mapping.yaml under the classpath:</p>
<pre><code>registry:
  client:
    serviceUrl:
      defaultZone: eureka.client.serviceUrl.defaultZone
</code></pre>

<p>After the mapping is defined, the framework maps by default when the configuration is loaded, and the configuration items defined by us are mapped to the configuration items that the open source component can recognize.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../inject-config/" class="btn btn-neutral float-right" title="Configuration injection">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../general-development/thread-model/" class="btn btn-neutral" title="Thread Model"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../general-development/thread-model/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../inject-config/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
