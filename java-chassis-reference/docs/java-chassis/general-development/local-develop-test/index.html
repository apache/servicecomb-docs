<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Local development and testing - ServiceComb Java Chassis 开发指南</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Local development and testing";
    var mkdocs_page_input_path = "general-development\\local-develop-test.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ServiceComb Java Chassis 开发指南</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../start/terminology/">Glossary</a>
                </li>
                <li class="">
                    
    <a class="" href="../../start/architecture/">Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../start/development-environment/">Development environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../start/first-sample/">Develop the first microservice</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Development Service Provider</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../build-provider/definition/service-definition/">Service definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/define-contract/">Service contract definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/code-first/">Implicit API definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/swagger-annotation/">Use Swagger annotations</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/springmvc/">Develop with SpringMVC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/jaxrs/">Develop with JAX-RS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/transparent-rpc/">Develop with Transparent RPC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/interface-constraints/">Interface definition and data type</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/listen-address-and-publish-address/">Service listening address and publishing address</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/thread-pool/">Thread pool</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Service Configuration</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/lb-strategy/">Load Balancing Policy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/ratelimite-strategy/">Rate Limiting Policy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/downgrade-strategy/">Fallback Policy</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-provider/configuration/parameter-validator/">Parameter Validator</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/bootup/">Boot-up Process</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-provider/access-log-configuration/">Access Log Configuration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Writing Service Consumer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../build-consumer/common-configuration/">Consumer common configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/using-resttemplate/">Using Rest Template</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/using-AsyncRestTemplate/">Using AsynRestTemplate</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/develop-consumer-using-rpc/">Using with RPC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/with-contract/">Contract</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Invoke control</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../build-consumer/circuit-breaker/">Circuit Breaker</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-consumer/flow-control/">Flow Control</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../build-consumer/fault-injection/">Fault Injection</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../build-consumer/3rd-party-service-invoke/">Invoke 3rd-party REST services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Transports</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../transports/rest-over-servlet/">REST over Servlet</a>
                </li>
                <li class="">
                    
    <a class="" href="../../transports/rest-over-vertx/">REST over Vertx</a>
                </li>
                <li class="">
                    
    <a class="" href="../../transports/highway-rpc/">Highway</a>
                </li>
                <li class="">
                    
    <a class="" href="../../transports/http2/">HTTP2</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">General Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../visit-sc/">Access Service Center</a>
                </li>
                <li class="">
                    
    <a class="" href="../metrics/">Metrics</a>
                </li>
                <li class="">
                    
    <a class="" href="../microservice-invocation-chain/">Microservice invocation chain</a>
                </li>
                <li class="">
                    
    <a class="" href="../customized-tracing/">Customized-Tracing</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Local development and testing</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#local-development-and-test">Local Development and Test</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#concept-description">Concept Description</a></li>
        
            <li><a class="toctree-l4" href="#starting-local-servicecenter">Starting Local ServiceCenter</a></li>
        
            <li><a class="toctree-l4" href="#mock-mechanism-start-service-center">Mock mechanism start service center</a></li>
        
            <li><a class="toctree-l4" href="#local-debugging-by-setting-environment-information">Local debugging by setting environment information</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../http-filter/">Http Filter</a>
                </li>
                <li class="">
                    
    <a class="" href="../file-upload/">File Uploading</a>
                </li>
                <li class="">
                    
    <a class="" href="../file-download/">File Downloading</a>
                </li>
                <li class="">
                    
    <a class="" href="../reactive/">Reactive Programing</a>
                </li>
                <li class="">
                    
    <a class="" href="../dnsconfig/">DNS Custom Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../dai-li-she-zhi/">Proxy Settings</a>
                </li>
                <li class="">
                    
    <a class="" href="../report-framework-version/">Report framework version</a>
                </li>
                <li class="">
                    
    <a class="" href="../cross-app-invocation/">Cross-application invocation</a>
                </li>
                <li class="">
                    
    <a class="" href="../secret-field/">Customized serialization and deserialization</a>
                </li>
                <li class="">
                    
    <a class="" href="../context/">Using Context to pass control messages</a>
                </li>
                <li class="">
                    
    <a class="" href="../produceprocess/">Return value serialization extension</a>
                </li>
                <li class="">
                    
    <a class="" href="../CORS/">CORS mechanism</a>
                </li>
                <li class="">
                    
    <a class="" href="../AlarmEvent/">Get fuse and instance isolation alarm event information</a>
                </li>
                <li class="">
                    
    <a class="" href="../shutdown/">Shutdown gracefully</a>
                </li>
                <li class="">
                    
    <a class="" href="../error-handling/">Handling exceptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../multienvironment/">Multi-environment isolation between microservice instances</a>
                </li>
                <li class="">
                    
    <a class="" href="../thread-model/">Thread Model</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../config/general-config/">General config</a>
                </li>
                <li class="">
                    
    <a class="" href="../../config/inject-config/">Configuration injection</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Service Capability Open</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../edge/by-servicecomb-sdk/">Using Edge Service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../edge/nginx/">Using confd and Nginx as edge services</a>
                </li>
                <li class="">
                    
    <a class="" href="../../edge/zuul/">Use zuul as edge services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Service Packing and Running</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../packaging/standalone/">Standalone mode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../packaging/web-container/">WEB container mode</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Micro Service Security</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../security/tls/">Using TLS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../security/rsa/">Using RSA certification</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Using java chassis in Spring Boot</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/components-for-spring-boot/">spring boot starter for java-chassis</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/java-application/">JAVA application development</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/web-application/">Web development method development</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/diff-between-java-web/">The difference between JAVA application method and Web development method</a>
                </li>
                <li class="">
                    
    <a class="" href="../../using-java-chassis-in-spring-boot/diff-spring-mvc/">The difference in Spring MVC mode</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Handlers reference</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../references-handlers/loadbalance/">Load Balancing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references-handlers/publickey/">Public key authentication</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">FAQ</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../question-and-answer/interface-compatibility/">Micro Service Interface Compatibility FAQ</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ServiceComb Java Chassis 开发指南</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>General Development &raquo;</li>
        
      
    
    <li>Local development and testing</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="local-development-and-test">Local Development and Test</h1>
<h2 id="concept-description">Concept Description</h2>
<p>This section describes how developers can locally develop and commission consumer and provider applications. Both service providers and consumers need to connect to the remote service center. Two methods of building Local  ServiceCenter for local microservice commissioning are as follows:</p>
<ul>
<li>
<p>Starting <a href="#section2945986191314">Local Service Center</a>。</p>
</li>
<li>
<p>Starting Local Service Center <a href="#section960893593759">Mock mechanism</a>。</p>
</li>
</ul>
<h3 id="local-debugging-by-setting-up-environmental-information">Local debugging by setting up environmental information</h3>
<p>The Service Center is an important component in the microservice architecture, this is used in managing and handle: registering and discovering, for service metadata and service instance metadata. The logic relationship between the service center and microservice provider/consumer is as follows:<img alt="" src="../../assets/images/local_develop_test_en.png" /></p>
<h2 id="starting-local-servicecenter">Starting Local ServiceCenter</h2>
<ul>
<li>
<p><strong>Step 1</strong> Starting local service center</p>
</li>
<li>
<p>run in executable files  </p>
</li>
</ul>
<p><ul class="nav nav-tabs">
     <li data-toggle="tab" class="active"><a data-toggle="tab" href="#windows">Windows</a></li>
     <li data-toggle="tab"><a data-toggle="tab" href="#linux">Linux</a></li>
   </ul></p>
<p><div class="tab-content">
     <div id="windows" class="tab-pane active" markdown="1">
    (1) Download the [Service Registry Executable Compressor] (http://apache.org/dyn/closer.cgi/incubator/servicecomb/incubator-servicecomb-service-center/1.0.0-m1/apache-servicecomb- Incubating-service-center-1.0.0-m1-windows-amd64.tar.gz)<br />
    (2) Extract to the current folder<br />
    (3) Go to the unzipped directory and double-click to run the <strong>start-service-center.bat</strong> file.  </p>
<p></div>
      <div id="linux" class="tab-pane fade" markdown="1">
    1) Download the Service Registry executable file archive and extract it<br />
<code>bash
   wget http://apache.org/dyn/closer.cgi/incubator/servicecomb/incubator-servicecomb-service-center/1.0.0-m1/apache-servicecomb-incubating-service-center-1.0.0-m1-linux-amd64.tar.gz
   tar xvf apache-servicecomb-incubating-service-center-1.0.0-m1-linux-amd64.tar.gz</code><br />
   2) Run the service registry<br />
<code>bash
   Bash apache-servicecomb-incubating-service-center-1.0.0-m1-linux-amd64/start-service-center.sh</code><br />
   
    Note: The frontend (frontend) will be bound to the ipv6 address by default in the Linux environment, causing the browser to report an error. The repair method is: first modify the httpaddr in conf/app.conf to the external reachable network card ip, and then modify the app/appList/apiList. .js <code>ip : 'http://127.0.0.1'</code> for the corresponding ip, and finally restart ServiceCenter.
  
    </div>
   </div></p>
<p>Note: Both Windows and Linux versions only support 64-bit systems.  </p>
<ol>
<li>Run as Docker  </li>
</ol>
<p><code>bash
Docker pull servicecomb/service-center
Docker run -d -p 30100:30100 servicecomb/service-center:latest</code></p>
<ul>
<li><strong>Step 2 </strong> After starting the local service center, configure the ServerCenter address and port in the service provider/consumer's microservice.yaml file. Example code:</li>
</ul>
<p><code>yaml
Servicecomb:
  Service:
    Registry:
      Address:
        #Service Center address and port
        Http://127.0.0.1:30100</code></p>
<ul>
<li><strong>Step 3 </strong>Development service provider/consumer, launch microservices for local testing.</li>
</ul>
<p><strong>----End</strong></p>
<h2 id="mock-mechanism-start-service-center">Mock mechanism start service center</h2>
<p>Simulate a service center that can only be used by this process in the process memory, which is generally used in the test scenario.
* ### In-process call
Just declare it before starting the ServiceComb engine to enable it:</p>
<pre><code class="java">System.setProperty(&quot;local.registry.file&quot;, &quot;notExistJustForceLocal&quot;);
</code></pre>

<ul>
<li>
<h3 id="cross-process-call">Cross-process call</h3>
<p>If the deployment is simple and the deployment information is static, you can use this mock mechanism even if you have a cross-process call.
The producer end is still declared like "in-process call"
However, because the Mock does not work across processes, the Mock on the consumer side needs to provide a local configuration file that describes the details of the call target, including the name, version, address, schema id, etc.
Similarly, because the Mock cannot cross processes, the consumer cannot dynamically obtain the contract information of the producer. Therefore, the contract file needs to be provided locally.
(This scenario, using the Mock Service Center, is much more costly than using a standalone service center, not recommended)</p>
</li>
<li>
<p><strong>Step 1</strong> Create a new local service center definition file, assuming the name is registry.yaml, the content example is as follows:  </p>
</li>
<li>
<p><strong>Step 1</strong> Create a new local service center definition file, assuming the name is registry.yaml, the content example is as follows:</p>
</li>
</ul>
<p><code>yaml
localserv:
  - id: "100"
    version: "0.0.1"
    appid: localservreg
    schemaIds:
      - hello
    instances:
      - endpoints:
        - rest://localhost:8080
        - highway://localhost:7070</code>
* <strong>Step 2</strong>consumer local deployment contract file</p>
<p>Reference: [Define Service Contract] (https://docs.servicecomb.io/java-chassis/zh_CN/build-provider/define-contract.html)
* <strong>Step 3</strong> In the consumer main function, declare the ServiceComb engine before starting:</p>
<p><code>java
　　System.setProperty("local.registry.file", "/path/registry.yaml");</code></p>
<p>The second parameter of setProperty fills in the absolute path of the registry.yaml system on the disk, pay attention to distinguish the corresponding path separator in different systems.</p>
<h2 id="local-debugging-by-setting-environment-information">Local debugging by setting environment information</h2>
<p>The java chassis is strictly dependent on the contract when designing, so usually the version of the microservice has to change when the contract updated. However, if the development mode is still in progress, it is normal to modify the interface. <br />
If you need to change the version every time, it is very unfriendly to the user, so an environment setting is added for this case. If the microservice is configured as a development environment, the interface is modified (the schema has changed), and the restart can be registered to the service center without modifying the version number.<br />
However, if  consumer client has already called the service before the restart, the consumer client needs to be restarted to get the latest schema. For example, A -&gt; B, B interface has been modified and restarted, then A is still using B last schema at this time, the call may be wrong, so as to avoid unknown exceptions, A also needs to restart. There are three ways to set it up, Recommended method 1  </p>
<ul>
<li>
<p>Method 1: Set by the JVM startup parameter <br />
<strong>-Dservice_description.environment=development</strong></p>
</li>
<li>
<p>Method 2: Specify by microservice.yaml configuration file</p>
</li>
</ul>
<pre><code class="yaml">service_description:
  environment: development
</code></pre>

<ul>
<li>Method 3: Specify by environment variable (only for Windows system), such as the following settings under Eclipse
<img alt="" src="../../assets/env.PNG" /></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../http-filter/" class="btn btn-neutral float-right" title="Http Filter">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../customized-tracing/" class="btn btn-neutral" title="Customized-Tracing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../customized-tracing/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../http-filter/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
